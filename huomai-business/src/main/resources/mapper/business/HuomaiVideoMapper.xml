<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.huomai.business.mapper.HuomaiVideoMapper">


    <select id="hotList" resultType="com.huomai.business.vo.HuomaiVideoHotVo">
        SELECT
            v.video_id,
            v.user_id,
            v.title,
            v.video_url,
            v.miusic_url,
            v.duration,
            v.topic,
            v.buddy,
            v.star_num,
            v.comment_num,
            v.view_num,
            v.share_num,
            v.create_time,
            u.uuid,
            u.nick_name,
            u.openid,
            u.phone,
            (select IF(count(1) > 0,1,0) from huomai_user_follow where follow_user_id = u.user_id  and user_id = #{bo.curUserId}) as attend_flag,
			(select IF(count(1) > 0,1,0) from huomai_video_love where video_id = v.video_id  and user_id = #{bo.curUserId}) as love_flag
        FROM
            huomai_video v
            INNER JOIN huomai_user u ON v.user_id = u.user_id
        WHERE
            v.`status` = '1'
            AND v.visible = '1'
    </select>
</mapper>
